{% load static %}
<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="description" content="REGISTRATION STEP 1: CONTACTO" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" />
    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- AXIOS -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <title>GNOSIS | CONTACTO</title>
</head>

<body>
    <header>
        <nav>
            <div class="nav-wrapper white" style="border: 1px solid rgba(192, 192, 192, 1)">
                <img class="responsive-img" style="height: 100%; width: 10%; padding-left: 25px"
                    src="{% static 'images/logo.png' %}" alt="Gnosis logo" />
            </div>
        </nav>
    </header>
    <main class="principal">
        <div class="principal col s12 m12 l12 row">
            <div class="col s6 m6 l6 center">
                <div class="col l12 center">
                    <img class="responsive-img" style="height: 100%; width: 50%; padding-top: 15px"
                        src="{% static 'images/fase1.png' %}" alt="fase1 contacto image" />
                    <h5 class="black-text" style="text-align: left; padding-left: 25px">
                        <b>Datos de contacto</b>
                    </h5>
                    <h6 class="grey-text" style="text-align: left; padding-left: 25px">
                        Actualice constantemente sus datos para que podamos contactarlo
                    </h6>
                </div>
                <div class="col l12 center">
                    {% if error %}
                    <div style="width: 100%; height: 24px; background-color: tomato">
                        <p style="color: white">{{ error }}</p>
                    </div>
                    {% endif %}
                    <form class="col l12 login-form" method="POST">
                        {% csrf_token %}
                        <div class="col l12 input-field">
                            <i class="material-icons prefix">call</i>
                            <label for="telefono" data-error="wrong" data-success="right">Telefono</label>
                            <input id="telefono" name="telefono" type="tel" class="validate" maxlength="12"
                                pattern="[0-9]{3}[ -][0-9]{3}[ -][0-9]{4}"
                                title="Use solo numeros y deje un espacio entre las series de digitos: 000-000-0000"
                                required />
                        </div>

                        <div class="col l6 input-field">
                            <select name="pais" required>
                                <option value="" disabled selected>Escoge una opción</option>
                                <option value="México">México (MX)</option>
                            </select>
                            <label>Pais</label>
                        </div>
                        <div class="col l6 input-field">
                            <i class="material-icons prefix">local_post_office</i>
                            <label for="cod_post " data-error="wrong" data-success="right">Codigo Postal</label>
                            <input id="cod_post" name="cod_post" type="number" class="validate" pattern="[0-9]{5,6}"
                                min="0" maxlength="6" title="El codigo postal debe tener un minimo de 5 caracteres"
                                required onchange="queryCP(document.getElementById('cod_post').value)" />
                        </div>

                        <div class="col l6 input-field">
                            <select name="estado" id="estado" required>
                                <option value="" disabled selected>Escoge una opción</option>
                            </select>
                            <label>Estado</label>
                        </div>

                        <div class="col l6 input-field">
                            <select name="ciudad" id="ciudad">
                                <option value="" disabled selected>Escoge una opción</option>
                            </select>
                            <label>Ciudad</label>
                        </div>

                        <div class="col l6 input-field">
                            <select name="municipio" id="municipio">
                                <option value="" disabled selected>Escoge una opción</option>
                            </select>
                            <label>Municipio</label>
                        </div>

                        <div class="col l6 input-field">
                            <select name="colonia" id="colonia">
                                <option value="" disabled selected>Escoge una opción</option>
                            </select>
                            <label>Colonia</label>
                        </div>
                        <div class="col l6 input-field">
                            <i class="material-icons prefix">cake</i>
                            <input id="fecha_nacimiento" name="fecha_nacimiento" type="text" class="datepicker"
                                name="fecha_nacimiento" title="El formato no es el correcto" required />
                            <label>Fecha de nacimieto</label>
                        </div>

                        <div class="col l6 input-field">
                            <select name="genero" required>
                                <option value="" disabled selected>Escoge una opción</option>
                                <option value="M">Hombre</option>
                                <option value="F">Mujer</option>
                            </select>
                            <label>Genero</label>
                        </div>

                        <div class="col l12">
                            <label>Disponibilidad</label>
                            <select name="disponibilidad" required>
                                <option value="" disabled selected>Escoge una opción</option>
                                <option value="1">Disponible</option>
                                <option value="0">No Disponible</option>
                            </select>
                        </div>
                        <br />
                        <button class="btn-large grey darken-3 waves-effect waves-light" type="submit" name="action">
                            Guardar y Continuar
                            <i class="material-icons right">save</i>
                        </button>
                    </form>
                </div>
            </div>

            <div class="col s12 m12 l6 center">
                <h2>
                    <b>AGREGA TU INFORMACIÓN DE</b>
                    <b class="blue-text text-darken-4">CONTACTO</b>
                    <b>PARA</b>
                    <b>COMUNICARNOS CONTIGO</b>
                </h2>

                <img class="responsive-img" style="height: 100%; width: 100%; padding-right: 155px"
                    src="{% static 'images/contact.png' %}" alt="Contact Ilustration" />
            </div>
        </div>
    </main>

    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-alpha.4/js/materialize.min.js"></script>
    <script src="{% static 'js/contact.js' %}?v=1.0"></script>

    <script>
        (function ($) {
            $(function () {
                // Plugin initialization
                $("select").not(".disabled").formSelect();
            });
        })(jQuery); // end of jQuery name space
    </script>
    <script>
        window.addEventListener("load", () => {
            const loader = document.querySelector(".loader");

            loader.classList.add("loader--hidden");

            loader.addEventListener("transitioned", () => {
                document.body.removeChild(loader);
            });
        });

        document.addEventListener("DOMContentLoaded", function () {
            var dates = document.querySelectorAll(".datepicker");
            M.Datepicker.init(dates, {
                format: "yyyy-mm-dd",
                setDefaultDate: true,
                defaultDate: new Date(2000, 0, 1),
                autoClose: true,
                showClearBtn: true,
                firstDay: 1,
                minDate: new Date(1959, 1, 12),
                maxDate: new Date(20026, 1, 12),
                i18n: {
                    cancel: "Cancelar",
                    clear: "Limpiar",
                    done: "Listo",
                    today: "Hoy",
                    previousMonth: "Mes anterior",
                    nextMonth: "Siguiente mes",
                    months: [
                        "Enero",
                        "Febrero",
                        "Marzo",
                        "Abril",
                        "Mayo",
                        "Junio",
                        "Julio",
                        "Agosto",
                        "Septiembre",
                        "Octubre",
                        "Noviembre",
                        "Diciembre",
                    ],
                    monthsShort: [
                        "Ene",
                        "Feb",
                        "Mar",
                        "Abr",
                        "May",
                        "Jun",
                        "Jul",
                        "Ago",
                        "Sep",
                        "Oct",
                        "Nov",
                        "Dic",
                    ],
                    weekdays: [
                        "Domingo",
                        "Lunes",
                        "Martes",
                        "Miércoles",
                        "Jueves",
                        "Viernes",
                        "Sábado",
                    ],
                    weekdaysShort: ["Dom", "Lun", "Mar", "Mié", "Jue", "Vie", "Sáb"],
                    weekdaysAbbrev: ["D", "L", "M", "M", "J", "V", "S"],
                },
                onClose: function () {
                    setTimeout(function () {
                        let fechaNacimiento =
                            document.getElementById("fecha_nacimiento").value;
                        let dateNacimiento = new Date(fechaNacimiento);
                        let dateActual = new Date();

                        let edad =
                            dateActual.getFullYear() - dateNacimiento.getFullYear();

                        // Ajustar la edad según el mes y el día actual
                        if (
                            dateNacimiento.getMonth() > dateActual.getMonth() ||
                            (dateNacimiento.getMonth() === dateActual.getMonth() &&
                                dateNacimiento.getDate() > dateActual.getDate())
                        ) {
                            edad--;
                        }

                        if (edad < 20) {
                            alert("Solo pueden registrarse personas mayores a 20 años");
                            document.getElementById("fecha_nacimiento").value = "";
                        }
                    }, 1000);
                },
            });
        });
    </script>
</body>

</html>